COD_CONTROLLO;COD_PROCESSO;COD_TIPO_CONTROLLO;COD_FREQ_CONTROLLO;COD_SEVERITA;DES_CONTROLLO;MSG;STMT_CONTROLLO;FLG_ATTIVO;TMS_CREAZIONE;TMS_MODIFICA;DAT_FINE_VALIDITA;COD_UTENTE_MODIFICA;COD_UTENTE_CREAZIONE
b;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY, il campo COD_PERIMETRO può contenere solo i valori “PATH_DEPENDENT” e “NO_PATH_DEPENDENT”;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity} la colonna COD_PERIMETRO contiene il valore {output2} per la chiave {output1}. ;;Y;;;;;MANUAL
c;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY, il campo ID_MESE_MAT può contenere solo interi da 1 a 480;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity} la chiave {output1} ha valore {output2}, esterno all'intervallo.;;Y;;;;;MANUAL
d;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Nella tabella TE_IRRBB_DISCOUNT_FACTOR, i valori di VAL_DELTA_DISC_FACTOR non possono essere pari a 0 se ID_MESE_MAT è maggiore di 0;Nella tabella TE_IRRBB_DISCOUNT_FACTOR {dat_report} v{versione_discount_factor} la chiave {output1} ha valore {output2}, esterno all'intervallo.;;Y;;;;;MANUAL
a.1;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica se ci sono valori duplicati nella tabella TE_IRRBB_SHIFT_SENSITIVITY;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity} la chiave {output1} viene ripetuta {output2} volte;;Y;;;;;MANUAL
a.2;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica se ci sono valori duplicati nella tabella TE_IRRBB_DISCOUNT_FACTOR;Nella tabella TE_IRRBB_DISCOUNT_FACTOR {dat_report} v{versione_discount_factor} la chiave {output1} viene ripetuta {output2} volte;;Y;;;;;MANUAL
a.3;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica se ci sono valori duplicati nella tabella TE_IRRBB_MAPPING_DES_SHOCK;Nella tabella TE_IRRBB_MAPPING_DES_SHOCK {dat_report} v{versione_mapping_des_shock} la chiave {output1} viene ripetuta {output2} volte;;Y;;;;;MANUAL
a.4;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica se ci sono valori duplicati nella tabella TE_IRRBB_MAPPING_CURRENCY;Nella tabella TE_IRRBB_MAPPING_CURRENCY {dat_report} v{versione_mapping_currency} la chiave {output1} viene ripetuta {output2} volte;;Y;;;;;MANUAL
a.5;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica se ci sono valori duplicati nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE {dat_report} v{versione_shift_sensitivity_base} la chiave {output1} viene ripetuta {output2} volte;;Y;;;;;MANUAL
e;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Nella tabella TE_IRRBB_DISCOUNT_FACTOR, il campo ID_MESE_MAT può contenere solo interi da 0 a 480;Nella tabella TE_IRRBB_DISCOUNT_FACTOR {dat_report} v{versione_discount_factor} la chiave {output1} ha valore {output2}, esterno all'intervallo.;;Y;;;;;MANUAL
f;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE, il campo ID_MESE_MAT può contenere solo interi da 1 a 480;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE {dat_report} v{versione_shift_sensitivity_base} la chiave {output1} ha valore {output2}, esterno all'intervallo.;;Y;;;;;MANUAL
g;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE il campo DES_SHOCK deve essere unico;Nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE {dat_report} v{versione_shift_sensitivity_base} la chiave {output1} ha valore {output2}, esterno all'intervallo.;;Y;;;;;MANUAL
1;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che tutti i DES_SHOCK presenti nella tabella TE_IRRBB_SHIFT_SENSITIVITY siano presenti nel campo DES_SHOCK_SHIFT_SENSITIVITY della tabella TE_IRRBB_MAPPING_DES_SHOCK.;Il DES_SHOCK {output1} risulta presente in TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity} ma non in DES_SHOCK_SHIFT_SENSITIVITY della tabella TE_IRRBB_MAPPING_DES_SHOCK {dat_report} v{versione_mapping_des_shock};;Y;;;;;MANUAL
2;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che tutti i DES_SHOCK_SHIFT_SENSITIVITY presenti nella tabella TE_IRRBB_MAPPING_DES_SHOCK siano presenti nel campo DES_SHOCK della tabella TE_IRRBB_SHIFT_SENSITIVITY;Il DES_SHOCK_SHIFT_SENSITIVITY {output1} risulta presente in TE_IRRBB_MAPPING_DES_SHOCK {dat_report} v{versione_mapping_des_shock} ma non in DES_SHOCK della tabella TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity};;Y;;;;;MANUAL
3;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che tutti i DES_SHOCK_DISCOUNT_FACTOR presenti nella tabella TE_IRRBB_MAPPING_DES_SHOCK siano presenti nel campo DES_SHOCK della tabella TE_IRRBB_DISCOUNT_FACTOR;Il DES_SHOCK_DISCOUNT_FACTOR {output1} risulta presente in TE_IRRBB_MAPPING_DES_SHOCK {dat_report} v{versione_mapping_des_shock} ma non in DES_SHOCK della tabella TE_IRRBB_DISCOUNT_FACTOR {dat_report} v{versione_discount_factor};;Y;;;;;MANUAL
4;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che tutte le COD_VALUTA_FINALE della tabella TE_IRRBB_MAPPING_CURRENCY siano presenti nel campo COD_VALUTA della tabella TE_IRRBB_DISCOUNT_FACTOR;Il COD_VALUTA_FINALE {output1} risulta presente in TE_IRRBB_MAPPING_CURRENCY {dat_report} v{versione_mapping_currency} ma non in COD_VALUTA della tabella TE_IRRBB_DISCOUNT_FACTOR {dat_report} v{versione_discount_factor};;Y;;;;;MANUAL
5;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che il campo DES_SHOCK della tabella TE_IRRBB_SHIFT_SENSITIVITY contenga un unico valore se COD_PERIMETRO=’NO_PATH_DEPENDENT’;Il campo DES_SHOCK presente in TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity} non contiene un unico valore quando COD_PERIMETRO=’NO_PATH_DEPENDENT’, ma ne contiene {output1};SELECT  COMPLETO.output1, RISULTATO.conteggio FROM  (SELECT COUNT(1) as conteggio,   1 as riferimento FROM  `{PROJECT_ID}.{DATASET_ECAP}.{SHIFT_SENSITIVITY}` WHERE DAT_REPORT ='{dat_report}'   AND ID_VERSIONE = {versione_shift_sensitivity} ) RISULTATO LEFT JOIN (SELECT count(DES_SHOCK) AS output1,  1 as riferimento FROM (   SELECT     distinct DES_SHOCK as  DES_SHOCK FROM     `{PROJECT_ID}.{DATASET_ECAP}.{SHIFT_SENSITIVITY}` WHERE DAT_REPORT ='{dat_report}'   AND ID_VERSIONE = {versione_shift_sensitivity} and COD_PERIMETRO = 'NO_PATH_DEPENDENT') HAVING count(DES_SHOCK)>=1 ) COMPLETO ON (COMPLETO.riferimento = RISULTATO.riferimento);Y;;;;;MANUAL
6;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che il campo DES_SHOCK della tabella TE_IRRBB_DISOCUNT_FACTOR contenga il valore BASE;Il campo DES_SHOCK presente in TE_IRRBB_DISOCUNT_FACTOR {dat_report} v{versione_discount_factor} non contiene il valore BASE;SELECT  COMPLETO.output1, RISULTATO.conteggio FROM  (SELECT COUNT(1) as conteggio,   1 as riferimento FROM  `{PROJECT_ID}.{DATASET_ECAP}.{DISCOUNT_FACTOR}` WHERE DAT_REPORT ='{dat_report}'   AND ID_VERSIONE = {versione_discount_factor} ) RISULTATO LEFT JOIN (SELECT NUM_DES_SHOCK AS output1,  1 as riferimento FROM (   SELECT COUNT(DES_SHOCK) as  NUM_DES_SHOCK FROM `{PROJECT_ID}.{DATASET_ECAP}.{DISCOUNT_FACTOR}` WHERE DAT_REPORT ='{dat_report}'   AND ID_VERSIONE = {versione_discount_factor} and DES_SHOCK = 'BASE' ) WHERE NUM_DES_SHOCK=0) COMPLETO ON (COMPLETO.riferimento = RISULTATO.riferimento);Y;;;;;MANUAL
7;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che nella tabella TE_IRRBB_DISCOUNT_FACTOR, per ogni valuta COD_VALUTA  e per ogni scenario di shock DES_SHOCK il campo ID_MESE_MAT abbia tutti e soli i valori interi da 0 fino a 480;Il campo ID_MESE_MAT presente in TE_IRRBB_DISCOUNT_FACTOR {dat_report} v{versione_discount_factor} non contiene un unico e solo valore per ogni COD_VALUTA e DES_SHOCK, per la coppia: {output1};SELECT  COMPLETO.output1, RISULTATO.conteggio FROM  (SELECT COUNT(1) as conteggio,   1 as riferimento FROM  `{PROJECT_ID}.{DATASET_ECAP}.{DISCOUNT_FACTOR}` WHERE DAT_REPORT ='{dat_report}' AND ID_VERSIONE = {versione_discount_factor} ) RISULTATO LEFT JOIN (SELECT DISTINCT NUM_ID_MESE_MAT AS NUM_ID_MESE_MAT, 1 as riferimento , concat(DES_SHOCK, '|', COD_VALUTA) as output1 FROM ( SELECT COUNT(ID_MESE_MAT) AS NUM_ID_MESE_MAT, DES_SHOCK, COD_VALUTA FROM `{PROJECT_ID}.{DATASET_ECAP}.{DISCOUNT_FACTOR}` WHERE DAT_REPORT ='{dat_report}' AND ID_VERSIONE = {versione_discount_factor} GROUP BY DES_SHOCK, COD_VALUTA ) WHERE NUM_ID_MESE_MAT != 481 ) COMPLETO ON   (COMPLETO.riferimento = RISULTATO.riferimento);Y;;;;;MANUAL
8;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che tutti i DES_SHOCK presenti nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE siano presenti nel campo DES_SHOCK_SHIFT_SENSITIVITY della tabella TE_IRRBB_MAPPING_DES_SHOCK.;Il DES_SHOCK {output1} risulta presente in TE_IRRBB_SHIFT_SENSITIVITY_BASE {dat_report} v{versione_shift_sensitivity_base} ma non in DES_SHOCK_SHIFT_SENSITIVITY della tabella TE_IRRBB_MAPPING_DES_SHOCK {dat_report} v{versione_mapping_des_shock};SELECT  COMPLETO.output1, RISULTATO.conteggio FROM  (SELECT COUNT(1) as conteggio,   1 as riferimento FROM   `{PROJECT_ID}.{DATASET_ECAP}.{SHIFT_SENSITIVITY_BASE}` WHERE DAT_REPORT ='{dat_report}'   AND ID_VERSIONE = {versione_shift_sensitivity_base} ) RISULTATO LEFT JOIN (SELECT DISTINCT A.DES_SHOCK AS output1,   1 as riferimento FROM (   SELECT     DES_SHOCK FROM     `{PROJECT_ID}.{DATASET_ECAP}.{SHIFT_SENSITIVITY_BASE}` WHERE     DAT_REPORT ='{dat_report}'     AND ID_VERSIONE = {versione_shift_sensitivity_base} ) A LEFT JOIN (   SELECT     DES_SHOCK_SHIFT_SENSITIVITY FROM     `{PROJECT_ID}.{DATASET_ECAP}.{MAPPING_DES_SHOCK}` WHERE     DAT_REPORT ='{dat_report}'     AND ID_VERSIONE ={versione_mapping_des_shock} ) B ON   A.DES_SHOCK = B.DES_SHOCK_SHIFT_SENSITIVITY WHERE   B.DES_SHOCK_SHIFT_SENSITIVITY IS NULL ) COMPLETO ON   (COMPLETO.riferimento = RISULTATO.riferimento);Y;;;;;MANUAL
9;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che nella tabella TE_IRRBB_SHIFT_SENSITIVITY, per ogni coppia (COD_VALUTA,COD_ENTITY), filtrando per COD_PERIMETRO=’PATH_DEPENDENT’, ci siano  n (n = numero complessivo di DES_SHOCK) diversi valori di DES_SHOCK;Nella tabella  TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity}, quando COD_PERIMETRO=’PATH_DEPENDENT’, per la coppia COD_VALUTA|COD_ENTITY: {output1} non ci sono n valori distinti di DES_SHOCK, ma ce ne sono {output2}.;SELECT  COMPLETO.output1, COMPLETO.output2, RISULTATO.conteggio FROM  (     SELECT COUNT(1) as conteggio,   1 as riferimento FROM  `{PROJECT_ID_SHIFT}.{DATASET_ECAP}.{SHIFT_SENSITIVITY}` WHERE     DAT_REPORT ='{dat_report}' AND ID_VERSIONE ={versione_shift_sensitivity} ) RISULTATO LEFT JOIN (SELECT concat(COD_VALUTA, '|' , COD_ENTITY) AS output1, count(distinct(DES_SHOCK)) as output2, 1 as riferimento FROM (SELECT     distinct DES_SHOCK, COD_VALUTA, COD_ENTITY FROM `{PROJECT_ID_SHIFT}.{DATASET_ECAP}.{SHIFT_SENSITIVITY}` WHERE DAT_REPORT ='{dat_report}' AND ID_VERSIONE ={versione_shift_sensitivity} and COD_PERIMETRO = 'PATH_DEPENDENT' ) group by COD_VALUTA, COD_ENTITY HAVING count(distinct(DES_SHOCK))!= (SELECT count(distinct(DES_SHOCK)) FROM `{PROJECT_ID_SHIFT}.{DATASET_ECAP}.{SHIFT_SENSITIVITY}` WHERE DAT_REPORT ='{dat_report}' AND ID_VERSIONE ={versione_shift_sensitivity} ) ) COMPLETO ON (COMPLETO.riferimento = RISULTATO.riferimento);Y;;;;;MANUAL
10;ecap11_irrbb_notional_equivalent;1;DAY;ERROR;Verifica che ogni coppia (COD_VALUTA,COD_ENTITY) della tabella TE_IRRBB_SHIFT_SENSITIVITY sia presente nella tabella del TE_IRRBB_SHIFT_SENSITIVITY_BASE;La coppia COD_VALUTA|COD_ENTITY: {output1} risulta presente in TE_IRRBB_SHIFT_SENSITIVITY {dat_report} v{versione_shift_sensitivity} ma non nella tabella TE_IRRBB_SHIFT_SENSITIVITY_BASE {dat_report} v{versione_shift_sensitivity_base};;Y;;;;;MANUAL
